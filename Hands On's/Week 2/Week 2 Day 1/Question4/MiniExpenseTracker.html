<!DOCTYPE html>
<html>
<head>
    <title>Mini Expense Tracker</title>
</head>
<body>

    <h2>Expense Tracker</h2>

    <input type="text" id="title" placeholder="Expense Title">
    <input type="number" id="amount" placeholder="Amount">
    <input type="date" id="date">
    <br><br>

    <button onclick="addExpense()">Add Expense</button>
    <button onclick="viewExpenses()">View Expenses</button>

    <h3>Expense List</h3>
    <table border="1" id="expenseTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Amount</th>
                <th>Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

<script>

    var db = openDatabase('ExpenseDB', '1.0', 'Expense Database', 2 * 1024 * 1024);

    db.transaction(function(tx) {
        tx.executeSql(
            'CREATE TABLE IF NOT EXISTS expenses (id INTEGER PRIMARY KEY AUTOINCREMENT, title TEXT, amount REAL, date TEXT)',
            [],
            function() {
                console.log("Table Created Successfully");
            },
            function(tx, error) {
                console.log("Table Creation Error: " + error.message);
            }
        );
    });

    function addExpense() {

        var title = document.getElementById("title").value;
        var amount = document.getElementById("amount").value;
        var date = document.getElementById("date").value;

        if(title === "" || amount === "" || date === "") {
            alert("Please fill all fields");
            return;
        }

        db.transaction(function(tx) {

            tx.executeSql(
                'INSERT INTO expenses (title, amount, date) VALUES (?, ?, ?)',
                [title, amount, date],
                function() {
                    alert("Expense Added Successfully");
                    viewExpenses();
                },
                function(tx, error) {
                    alert("Insert Error: " + error.message);
                }
            );

        }, function(error) {
            alert("Transaction Error: " + error.message);
        });
    }

    function viewExpenses() {

        db.transaction(function(tx) {

            tx.executeSql(
                'SELECT * FROM expenses',
                [],
                function(tx, results) {

                    var tbody = document.querySelector("#expenseTable tbody");
                    tbody.innerHTML = "";

                    for(var i = 0; i < results.rows.length; i++) {
                        var row = results.rows.item(i);

                        var tr = document.createElement("tr");

                        tr.innerHTML =
                            "<td>" + row.id + "</td>" +
                            "<td>" + row.title + "</td>" +
                            "<td>" + row.amount + "</td>" +
                            "<td>" + row.date + "</td>" +
                            "<td><button onclick='deleteExpense(" + row.id + ")'>Delete</button></td>";

                        tbody.appendChild(tr);
                    }

                },
                function(tx, error) {
                    alert("Select Error: " + error.message);
                }
            );

        });
    }

    function deleteExpense(id) {

        db.transaction(function(tx) {

            tx.executeSql(
                'DELETE FROM expenses WHERE id=?',
                [id],
                function() {
                    alert("Expense Deleted");
                    viewExpenses();
                },
                function(tx, error) {
                    alert("Delete Error: " + error.message);
                }
            );

        }, function(error) {
            alert("Transaction Error: " + error.message);
        });
    }

</script>

</body>
</html>